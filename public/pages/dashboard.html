<div class="grid-dashboard">
    <template x-for="card in dashboardCards" :key="card.id">
        <div class="dashboard-card" @click="navigateToCard(card.target)">
            <div class="dashboard-card-header">
                <span class="dashboard-card-icon" x-text="card.icon"></span>
                <h3 class="dashboard-card-title" x-text="card.title"></h3>
            </div>
            <p class="dashboard-card-description" x-text="card.description"></p>
        </div>
    </template>
</div>

<!-- API Configuration -->
<div class="section-spacing card card-body" x-show="!isAdmin && isCloud" x-data="apiKeyConfig">
    <h3 class="card-title mb-4">üîë API Configuration</h3>
    <div x-show="!hasApiKey" class="form-group">
        <div class="alert alert-warning">
            <div class="flex-center mb-2">
                <span class="text-medium">‚ö†Ô∏è OpenRouter API Key Required</span>
            </div>
            <p class="text-small mb-3">
                You need an OpenRouter API key to generate data. Get one from 
                <a href="https://openrouter.ai/keys" target="_blank" class="link">openrouter.ai/keys</a>
            </p>
            <form @submit.prevent="saveApiKey()" class="stack-3">
                <input type="text" x-model="newApiKey" 
                       class="form-input font-mono"
                       placeholder="sk-or-v1-..." 
                       autocomplete="off"
                       spellcheck="false">
                <div class="flex cluster-2">
                    <button type="submit" class="btn btn-primary">Save API Key</button>
                    <button type="button" @click="showApiKeyHelp = !showApiKeyHelp" class="btn btn-ghost">Help</button>
                </div>
            </form>
        </div>
        <div x-show="showApiKeyHelp" class="alert alert-info">
            <h4 class="text-medium mb-2">How to get OpenRouter API Key:</h4>
            <ol class="text-small list-decimal">
                <li>Visit <a href="https://openrouter.ai/keys" target="_blank" class="link">openrouter.ai/keys</a></li>
                <li>Sign up or log in to your account</li>
                <li>Create a new API key</li>
                <li>Copy and paste it above</li>
            </ol>
        </div>
    </div>
    <div x-show="hasApiKey" class="form-group">
        <div class="alert alert-success">
            <div class="flex-between mb-2">
                <span class="text-medium">‚úÖ API Key Configured</span>
                <button @click="updateApiKey()" class="btn btn-ghost btn-sm">Update</button>
            </div>
            <div class="text-small" x-text="accountInfo"></div>
        </div>
    </div>
</div>

<!-- Admin Panel -->
<div class="section-spacing card card-body" x-show="isAdmin" x-data="adminPanel">
    <h3 class="text-large text-medium text-primary mb-4">üîß Admin Tools</h3>
    <div class="grid-2 gap-4">
        <div class="admin-card admin-card-info">
            <h4 class="text-medium text-info-dark mb-2">System Status</h4>
            <p class="text-small text-secondary-dark">All systems operational</p>
        </div>
        <div class="admin-card admin-card-success">
            <h4 class="text-medium text-success-dark mb-2">Active Users</h4>
            <p class="text-small text-secondary-dark" x-text="`${users.length} registered users`"></p>
        </div>
    </div>
    <div class="mt-4 flex cluster-2">
        <button @click="showUsersModal = true" class="btn btn-primary">Manage Users</button>
        <button @click="logout()" class="btn btn-danger">Logout</button>
    </div>
    
    <!-- Users Modal -->
    <div x-show="showUsersModal" @click.away="showUsersModal = false" 
         class="fixed inset-0 bg-black bg-opacity-50 flex-center z-50">
        <div class="bg-white rounded-lg p-6 max-w-2xl w-full max-h-96 overflow-y-auto">
            <h3 class="text-lg font-semibold mb-4">User Management</h3>
            <table class="w-full">
                <thead>
                    <tr class="border-b">
                        <th class="text-left p-2">Username</th>
                        <th class="text-left p-2">Admin</th>
                        <th class="text-left p-2">Has API Key</th>
                        <th class="text-left p-2">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <template x-for="user in users" :key="user.id">
                        <tr class="border-b">
                            <td class="p-2" x-text="user.username"></td>
                            <td class="p-2" x-text="user.isAdmin ? 'Yes' : 'No'"></td>
                            <td class="p-2" x-text="user.hasApiKey ? 'Yes' : 'No'"></td>
                            <td class="p-2">
                                <button @click="resetUserPassword(user.id)" 
                                        class="text-blue-600 hover:text-blue-800 mr-2">Reset Password</button>
                                <button @click="deleteUser(user.id)" 
                                        class="text-red-600 hover:text-red-800">Delete</button>
                            </td>
                        </tr>
                    </template>
                </tbody>
            </table>
            <button @click="showUsersModal = false" class="btn btn-secondary mt-4">Close</button>
        </div>
    </div>
</div>