<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM Data Generator - Create AI-powered data</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    
    <!-- Reset CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@unocss/reset/tailwind.min.css">
    
    <!-- Design System -->
    <link rel="stylesheet" href="/css/design-system.css?v=4">
    
    <!-- Marked.js for Markdown rendering -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <!-- Initialize App -->
    <script type="module">
        import './js/app.js';
        // Load Alpine after app module
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js';
        script.defer = true;
        document.head.appendChild(script);
    </script>
</head>
<body class="h-screen text-gray-700">
    <div id="app" x-data="app" x-init="init">
        <!-- Loading Screen -->
        <div x-show="loading" class="fixed inset-0 bg-white z-50 flex items-center justify-center">
            <div class="text-center">
                <div class="text-3xl mb-m">ü§ñ</div>
                <div class="text-lg font-medium text-gray-600">Loading...</div>
            </div>
        </div>

        <!-- Main App -->
        <div x-show="!loading" x-transition>
            <!-- Header -->
            <header class="bg-white border-b border-gray-200 shadow-sm sticky top-0 z-50">
                <div class="container">
                    <div class="action-row py-m">
                        <!-- Logo & Title -->
                        <div class="flex items-center gap-s">
                            <span class="text-2xl">ü§ñ</span>
                            <h1 class="text-lg font-semibold text-gray-800">LLM Data Generator</h1>
                        </div>

                        <!-- Account Info -->
                        <div class="flex items-center gap-m">
                            <!-- Balance Display -->
                            <div x-show="accountInfo" class="flex items-center gap-m text-sm">
                                <div class="flex items-center gap-s">
                                    <span class="text-gray-500">Balance:</span>
                                    <span class="font-medium text-gray-800">$<span x-text="accountInfo?.balance || '0'"></span></span>
                                </div>
                                <div class="text-gray-400">‚Ä¢</div>
                                <div class="flex items-center gap-s">
                                    <span class="text-gray-500">Limit:</span>
                                    <span class="font-medium text-gray-800">$<span x-text="accountInfo?.limit || '0'"></span></span>
                                </div>
                                <div class="text-gray-400">‚Ä¢</div>
                                <div class="flex items-center gap-s">
                                    <span class="text-gray-500">Used:</span>
                                    <span class="font-medium" 
                                          :class="accountInfo?.percentUsed > 80 ? 'text-error' : accountInfo?.percentUsed > 50 ? 'text-warning' : 'text-success'"
                                          x-text="(accountInfo?.percentUsed || 0) + '%'"></span>
                                </div>
                            </div>

                            <!-- User Menu -->
                            <div x-show="isAuthenticated" class="relative" x-data="{ open: false }">
                                <button @click="open = !open" class="btn btn-ghost btn-sm">
                                    <span class="text-lg">üë§</span>
                                </button>
                                
                                <div x-show="open" @click.away="open = false" 
                                     x-transition
                                     class="dropdown-menu">
                                    <div class="px-m py-s border-b border-gray-200">
                                        <div class="text-sm font-medium text-gray-700" x-text="user?.email"></div>
                                    </div>
                                    <a href="#" @click="logout" class="nav-link">
                                        üö™ Sign out
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Main Layout -->
            <div class="flex h-screen">
                <!-- Sidebar Navigation -->
                <nav class="sidebar">
                    <div class="stack-s">
                        <template x-for="item in navigation" :key="item.path">
                            <a :href="'#' + item.path"
                               @click="currentRoute = item.path"
                               :class="currentRoute === item.path ? 'nav-link nav-link-active' : 'nav-link'">
                                <span class="text-xl" x-text="item.icon"></span>
                                <span x-text="item.label"></span>
                            </a>
                        </template>
                    </div>

                    <!-- Admin Section -->
                    <div x-show="isAdmin" class="mt-l pt-l border-t border-gray-200">
                        <div>
                            <div class="text-sm font-medium text-gray-500 uppercase mb-s">Admin</div>
                            <a href="#/admin"
                               @click="currentRoute = '/admin'"
                               :class="currentRoute === '/admin' ? 'nav-link nav-link-active' : 'nav-link'">
                                <span class="text-xl">üë•</span>
                                <span>Users</span>
                            </a>
                        </div>
                    </div>
                </nav>

                <!-- Page Content -->
                <main class="flex-1 p-m">
                    <div class="max-w-4xl mx-auto">
                        <!-- API Key Warning -->
                        <div x-show="!loading && !hasApiKey" class="alert alert-warning mb-m">
                            <div class="flex justify-between items-center">
                                <div>
                                    <p class="font-medium">‚ö†Ô∏è No API key configured</p>
                                    <p class="text-sm mt-s">You need to configure your OpenRouter API key to generate data.</p>
                                </div>
                                <a href="#/settings" class="btn btn-primary btn-sm">
                                    Configure API Key
                                </a>
                            </div>
                        </div>
                        
                        <!-- Router Content Container -->
                        <div id="page-content"></div>
                    </div>
                </main>
            </div>
        </div>

        <!-- Notifications -->
        <div id="notifications" class="notification-container stack-s"></div>
    </div>
</body>
</html>